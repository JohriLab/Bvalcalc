


<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bvalcalc Documentation &mdash; Bvalcalc 0.6.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=71ff9720" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=1c28bd9a"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/js/onthispage-scrollspy.js?v=33cab78c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="introduction/installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Bvalcalc
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/bedgff_input.html">BED/GFF Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/generate_params.html">Generate Parameters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules/site.html">Calculate Single Site B</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/gene.html">Calculate Gene B Recovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/region.html">Calculate Region B-map</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/genome.html">Calculate Genome B-map</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/bmap_utils.html">B-map Utilities for VCF</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="guides/quickstart.html">Quickstart Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides/params.html">Tailoring Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides/multiple_dfes.html">Multiple DFEs</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides/demography.html">Demographic Inference with B-map</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides/sweepfinder2.html">SweepFinder2 with B-map</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/calculateB.html">Calculate B</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About BGS and B-values</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="prebuilt_maps/learn.html">Work in Progress…</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Query species B-maps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="prebuilt_maps/query.html">Work in Progress…</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Bvalcalc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Bvalcalc Documentation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bvalcalc-documentation">
<h1>Bvalcalc Documentation<a class="headerlink" href="#bvalcalc-documentation" title="Link to this heading"></a></h1>
<p>Welcome to the documentation for <strong>Bvalcalc</strong>, a CLI tool for easily calculating B-values and B-maps.</p>
<p>Background selection (BGS) is the process by which diversity is reduced at neutral sites linked to conserved regions such as exons that experience direct purifying selection, and across the genome. <strong>bvalcalc</strong> allows users to easily calculate the relative reduction of diversity due to BGS (B) using several different modes. Calculating B-values is important for understanding the linked effects of selection, can be used to establish an evolutionary null model for inference, and can aid in selecting the most neutrally evolving sites, see <a class="reference internal" href="guides/demography.html"><span class="doc">Demographic Inference with B-map</span></a>.</p>
<p>To learn more about background selection, see <a class="reference internal" href="prebuilt_maps/learn.html"><span class="doc">About BGS and B-values</span></a>. To access pre-built B-maps for select species, see <a class="reference internal" href="prebuilt_maps/query.html"><span class="doc">Query Species B-maps</span></a>. To calculate B-values for yourself, install <strong>bvalcalc</strong> and explore the docs, we recommend getting started with the <a class="reference internal" href="guides/quickstart.html"><span class="doc">Quickstart Tutorial</span></a>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go"> bvalcalc [--generate_params [SPECIES]|--site|--gene|--region|--genome]</span>

<span class="go">--generate_params [SPECIES]</span>
<span class="go">                      Save population parameters from a species template (human, drosophila, arabidopsis, celegans, mouse, pfalciparum, selfing)</span>
<span class="go">--site, -s            Calculate B values for a single site from a selected element</span>
<span class="go">--gene, -g            Calculate B values for a region adjacent to a single selected element</span>
<span class="go">--region, -r          Calculate B values for a chromosomal region, considering genome-wide effects</span>
<span class="go">--genome, -w          Calculate B values genome-wide for all sites considering all elements</span>
</pre></div>
</div>
<img alt="B region example" class="with-shadow align-center" src="_images/B_chr21.png" />
<p><em>B-values from linked CDS across ~6 Mb of human chromosome 21, calculated with the --region module in 13.16 seconds</em></p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/bedgff_input.html">BED/GFF Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/generate_params.html">Generate Parameters</a></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules/site.html">Calculate Single Site B</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/gene.html">Calculate Gene B Recovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/region.html">Calculate Region B-map</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/genome.html">Calculate Genome B-map</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/bmap_utils.html">B-map Utilities for VCF</a></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="guides/quickstart.html">Quickstart Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guides/quickstart.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/quickstart.html#specifying-popgen-parameters">Specifying popgen parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/quickstart.html#calculating-a-b-value">Calculating a B value</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/quickstart.html#b-recovery-from-one-element">B recovery from one element</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/quickstart.html#b-in-a-genomic-region">B in a genomic region</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/quickstart.html#calculating-a-b-map">Calculating a B-map</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guides/params.html">Tailoring Parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guides/params.html#core-parameters">Core parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/params.html#dfe-parameters">DFE parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/params.html#demography">Demography</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/params.html#selfing-species">Selfing species</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guides/multiple_dfes.html">Multiple DFEs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guides/multiple_dfes.html#arguments">Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/multiple_dfes.html#example-walkthrough">Example Walkthrough</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guides/demography.html">Demographic Inference with B-map</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guides/demography.html#plotting-the-b-distribution">Plotting the B distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/demography.html#saving-positions-with-high-b">Saving positions with high B</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/demography.html#filtering-a-vcf">Filtering a VCF</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guides/sweepfinder2.html">SweepFinder2 with B-map</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guides/sweepfinder2.html#sf2-b-map-format">SF2 B-map format</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/sweepfinder2.html#bvalcalc-to-sf2-format">Bvalcalc to SF2 format</a></li>
<li class="toctree-l2"><a class="reference internal" href="guides/sweepfinder2.html#notes">Notes</a></li>
</ul>
</li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/calculateB.html">Calculate B</a></li>
</ul>
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="introduction/installation.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Jacob Marsh, Parul Johri.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
   
  <!-- To bottom button -->
  <div class="scroll-bottom-wrapper">
    <button class="scroll-to-bottom-btn" aria-label="Scroll to bottom">
      <span class="scroll-to-bottom-btn-text">↓ ↓ ↓</span>
    </button>
  </div>
  <!-- Right elements -->
  <div class="right-elements-container">
    <div class="on-this-page">
        <ul>
<li><a class="reference internal" href="#">Bvalcalc Documentation</a><ul>
</ul>
</li>
</ul>

    </div>
    <img src="_static/Bvalcalc_bee_trail.svg" aria-hidden="true" class="bee-trail-img" />
    <div class="bottom-right-elements">
      <div class="citation-text">
        <strong>Citation:</strong><br/>Marsh, JI, Johri, PJ (2025).
        <span class="citation-body">
          The B-value calculator: efficient analytical calculation of expected
          genetic diversity with background selection. <i>bioRxiv</i>. 
        </span>
        <a href="https://biorxiv" target="_blank" rel="noopener noreferrer">10.1101/2063.10.10.561727</a>
      </div>      
      <div class="made-by-sphinx-text">
        Made with <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener noreferrer">Sphinx</a>
        using an adapted <a href="https://github.com/rtfd/sphinx_rtd_theme" target="_blank" rel="noopener noreferrer">theme</a> 
        from <a href="https://readthedocs.org/" target="_blank" rel="noopener noreferrer">Read the Docs</a> <br/>
      </div>
      <div class="links-text">
        <a href="https://test.pypi.org/project/Bvalcalc/" target="_blank" rel="noopener noreferrer">PyPI</a> | 
        <a href="https://github.com/JohriLab/Bvalcalc/issues" target="_blank" rel="noopener noreferrer">Report a bug</a> | 
        <a href="https://github.com/JohriLab/Bvalcalc" target="_blank" rel="noopener noreferrer">Source code</a> 
      </div>
    </div>  
  </div>


</body>
</html>